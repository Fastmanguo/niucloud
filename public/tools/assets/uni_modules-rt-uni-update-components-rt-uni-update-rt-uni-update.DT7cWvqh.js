import{_ as t,c as e,w as a,cb as s,K as o,ab as n,i,o as d,f as l,h as c,q as r,p as u,t as p,P as f,an as _,cc as h,aB as b,Q as m,R as k}from"./index-DlbBJ3bC.js";const g=t({data:()=>({version:"1.0.0",percent:0,updateBtn:!0,cancleBtn:!1,downloadedSize:0,packageFileSize:0,data:{describe:"1. 修复已知问题<br>2. 优化用户体验",edition_url:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-6bef1fe3-e3e3-4909-9f0c-6ed9bd11c93b/aae2360a-6628-4c93-b873-ce1600b9a852.apk",edition_force:1,package_type:0,edition_name:"1.0.1"}}),onHide(){this.data.edition_force=0,n({delta:1})},onLoad({obj:t}){this.data=JSON.parse(t),0==this.data.edition_force&&(this.cancleBtn=!0),plus.runtime.getProperty(plus.runtime.appid,(t=>{this.version=t.version}))},onBackPress(){if(1==this.data.edition_force)return!0},methods:{cancel(){n({delta:1})},confirm(){0==this.data.package_type?this.data.edition_url.includes(".apk")?(this.updateBtn=!1,this.cancleBtn=!1,this.download()):(this.data.edition_force=0,plus.runtime.openURL(this.data.edition_url),n({delta:1})):(this.updateBtn=!1,this.cancleBtn=!1,this.download())},download(){let t=this.data.package_type,e=this;s({url:this.data.edition_url,success:a=>{200===a.statusCode&&(plus.runtime.install(a.tempFilePath,{force:!0},(function(){1==t&&plus.runtime.restart()}),(function(t){e.data.edition_force=0,o({title:t.message,icon:"none",duration:2500}),setTimeout((()=>{n()}),2e3)})),0==t&&(this.data.edition_force=0,n()))}}).onProgressUpdate((t=>{this.percent=t.progress,this.downloadedSize=(t.totalBytesWritten/Math.pow(1024,2)).toFixed(2),this.packageFileSize=(t.totalBytesExpectedToWrite/Math.pow(1024,2)).toFixed(2)}))}}},[["render",function(t,s,o,n,g,y){const B=r,w=i,x=f,v=h,F=_,C=b,S=m;return d(),e(w,{class:"update-mask flex-center"},{default:a((()=>[l(w,{class:"content botton-radius"},{default:a((()=>[l(w,{class:"content-top"},{default:a((()=>[l(w,{class:"content-top-text"},{default:a((()=>[l(B,{class:""},{default:a((()=>[u("发现新版本 v"+p(g.data.edition_name),1)])),_:1}),l(B,{class:"version"},{default:a((()=>[u("当前版本："+p(g.version),1)])),_:1})])),_:1}),l(x,{class:"content-top",style:{top:"0"},width:"100%",height:"100%",src:"/tools/uni_modules/rt-uni-update/static/bg_top.png"})])),_:1}),l(w,{class:"content-header"}),l(w,{class:"content-body"},{default:a((()=>[l(w,{class:"title"},{default:a((()=>[l(B,null,{default:a((()=>[u("更新内容")])),_:1})])),_:1}),l(w,{class:"body"},{default:a((()=>[l(F,{class:"box-des-scroll","scroll-y":"true"},{default:a((()=>[l(v,{nodes:g.data.describe},null,8,["nodes"])])),_:1})])),_:1}),l(w,{class:"footer flex-center"},{default:a((()=>[g.updateBtn?c("",!0):(d(),e(w,{key:0,class:"progress-box flex-column"},{default:a((()=>[l(C,{class:"progress","border-radius":"35",percent:g.percent,activeColor:"#3DA7FF","show-info":"","stroke-width":"10"},null,8,["percent"]),l(w,null,{default:a((()=>[l(B,{class:"fs24"},{default:a((()=>[u("正在下载，请稍后 ("+p(g.downloadedSize)+"/"+p(g.packageFileSize)+"M)",1)])),_:1})])),_:1})])),_:1})),g.updateBtn?(d(),e(S,{key:1,class:"content-button",style:{border:"none",color:"#fff"},plain:"",onClick:y.confirm},{default:a((()=>[u("立即升级")])),_:1},8,["onClick"])):c("",!0)])),_:1})])),_:1}),g.cancleBtn?(d(),e(x,{key:0,class:"close-img",src:"/tools/uni_modules/rt-uni-update/static/app_update_close.png",onClick:k(y.cancel,["stop"])},null,8,["onClick"])):c("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-34523277"]]);export{g as default};
