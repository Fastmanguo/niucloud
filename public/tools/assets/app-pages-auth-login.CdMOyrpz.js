import{d as e,s as a,E as l,r as s,j as t,F as r,a2 as o,H as u,I as n,W as i,a3 as m,c,h as d,w as p,n as g,i as f,L as b,b as h,e as x,m as v,Y as _,Z as y,$ as k,N as w,O as C,a4 as T,o as j,f as P,u as S,M as B,p as V,t as q,a5 as L,a6 as A,a7 as z,R as I,q as R,a as W,Q as E,K as F,a8 as N,a9 as O,G as U,S as Y,aa as Z,ab as $,_ as G}from"./index-DlbBJ3bC.js";import{_ as H}from"./top-tabbar.DzgP6uDu.js";import{t as K}from"./topTabbar.CE7B52mt.js";import"./manifest.DY5wYu7I.js";const M=G(e({__name:"login",setup(e){let E={};const Z=K(),$=Z.setTopTabbarParam({title:a("login"),topStatusBar:{bgColor:"#fff",textColor:"#333"}}),G=l((()=>Object.keys(E).length?b(Number(E.height))+b(E.top)+b(8)+"rpx":"auto")),M=s(!0),Q=t(),D=r(),J=s(""),X=s(!1),ee=s(!1),ae=o();u((async e=>{J.value="username",n()?!D.login.is_username||D.login.is_mobile||D.login.is_auth_register?ee.value=!0:ee.value=!1:D.login.is_username&&!D.login.is_mobile?ee.value=!1:ee.value=!0}));const le=i({username:"",password:"",mobile:"",mobile_code:"",mobile_key:""});m((()=>{setTimeout((()=>{M.value=!1}),800)}));const se=()=>{X.value=!X.value},te=()=>{J.value="username"==J.value?"mobile":"username"},re=s(!1),oe=l((()=>({username:{type:"string",required:"username"==J.value,message:a("usernamePlaceholder"),trigger:["blur","change"]},password:{type:"string",required:"username"==J.value,message:a("passwordPlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:"mobile"==J.value,message:a("mobilePlaceholder"),trigger:["blur","change"]},{validator:(e,a)=>"mobile"!=J.value||uni.$u.test.mobile(a),message:a("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:"mobile"==J.value,message:a("codePlaceholder"),trigger:["blur","change"]}}))),ue=s(null),ne=()=>{ue.value.validate().then((()=>{if(D.login.agreement_show&&!X.value)return F({title:a("isAgreeTips"),icon:"none"}),!1;if(re.value)return;re.value=!0;("username"==J.value?N:O)(le).then((e=>{Q.setToken(e.data.token,(async()=>{await U().getSiteInfoFn(),Y().handleLoginBack()}))})).catch((()=>{re.value=!1}))}))};return(e,l)=>{const s=h(x("top-tabbar"),H),t=f,r=h(x("up-image"),v),o=h(x("u-input"),_),u=h(x("u-form-item"),y),n=h(x("u-form"),k),i=h(x("u-checkbox"),w),m=h(x("u-checkbox-group"),C),b=R,E=h(x("up-button"),T);return J.value?(j(),c(t,{key:0,class:"w-screen h-screen flex flex-col bg-[#fff]",style:g(e.themeColor())},{default:p((()=>[P(t,{style:g({height:G.value})},{default:p((()=>[P(s,{data:S($),scrollBool:S(Z).getScrollBool(),class:"top-header"},null,8,["data","scrollBool"])])),_:1},8,["style"]),P(t,{class:"my-20 px-5"},{default:p((()=>[P(t,{class:"flex items-center mb-5"},{default:p((()=>[P(r,{"show-loading":!0,src:S(B)(S(ae).app_logo),width:"50px",height:"50px",radius:"50px"},null,8,["src"]),P(t,{class:"ml-2 text-base text-[var(--theme-color-main)] font-semibold"},{default:p((()=>[P(t,{class:"font-serif subpixel-antialiased"},{default:p((()=>[V(q(S(ae).app_name),1)])),_:1}),P(t,{class:"text-[var(--theme-color-main)]"},{default:p((()=>[V(q(S(a)("accountLogin")),1)])),_:1})])),_:1})])),_:1}),P(n,{labelPosition:"left",model:le,rules:oe.value,ref_key:"formRef",ref:ue},{default:p((()=>["username"==J.value?(j(),L(A,{key:0},[P(u,{prop:"username",borderBottom:"",labelWidth:"0px",labelStyle:"font-size: 14px;"},{default:p((()=>[P(o,{modelValue:le.username,"onUpdate:modelValue":l[0]||(l[0]=e=>le.username=e),maxlength:"40",placeholder:S(a)("usernamePlaceholder"),clearable:"",autocomplete:"off",class:"!bg-transparent",disabled:M.value,fontSize:"14px"},null,8,["modelValue","placeholder","disabled"])])),_:1}),P(u,{label:"",prop:"password","border-bottom":!1,labelWidth:"0px"},{default:p((()=>[P(o,{modelValue:le.password,"onUpdate:modelValue":l[1]||(l[1]=e=>le.password=e),type:"password",maxlength:"40",clearable:"",placeholder:S(a)("passwordPlaceholder"),autocomplete:"new-password",class:"!bg-transparent",disabled:M.value},null,8,["modelValue","placeholder","disabled"])])),_:1})],64)):d("",!0)])),_:1},8,["model","rules"]),P(t,{class:z({"mt-[160rpx]":"username"!=J.value,"mt-[106rpx]":"username"==J.value})},{default:p((()=>[S(D).login.agreement_show?(j(),c(t,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:I(se,["stop"])},{default:p((()=>[P(m,{onChange:se},{default:p((()=>[P(i,{activeColor:"var(--primary-color)",checked:X.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),P(t,{class:"text-xs text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:p((()=>[P(b,null,{default:p((()=>[V(q(S(a)("agreeTips")),1)])),_:1}),P(b,{onClick:l[2]||(l[2]=I((e=>S(W)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:p((()=>[V("《"+q(S(a)("privacyAgreement"))+"》 ",1)])),_:1}),P(b,null,{default:p((()=>[V(q(S(a)("and")),1)])),_:1}),P(b,{onClick:l[3]||(l[3]=I((e=>S(W)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:p((()=>[V("《"+q(S(a)("userAgreement"))+"》 ",1)])),_:1})])),_:1})])),_:1})):d("",!0),P(E,{text:S(a)("login"),color:"var(--theme-color-primary)",loadingText:S(a)("logining"),onClick:ne},null,8,["text","loadingText"]),P(t,{class:"flex items-center justify-between my-3"},{default:p((()=>["username"==J.value&&S(D).login.is_mobile||"mobile"==J.value&&S(D).login.is_username?(j(),c(t,{key:0,class:"text-[26rpx] text-[var(--text-color-light6)] leading-[34rpx]",onClick:te},{default:p((()=>[V(q("username"==J.value?S(a)("mobileLogin"):S(a)("accountLogin")),1)])),_:1})):d("",!0),P(t,{class:"text-xs flex justify-center items-center w-full text-[var(--theme-color-content)]",onClick:l[4]||(l[4]=e=>S(W)({url:"/app/pages/auth/register"}))},{default:p((()=>[P(b,null,{default:p((()=>[V(q(S(a)("noAccount"))+",",1)])),_:1}),P(b,{class:"text-primary"},{default:p((()=>[V(q(S(a)("toRegister")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["class"])])),_:1}),d("",!0)])),_:1},8,["style"])):d("",!0)}}}),[["__scopeId","data-v-aba05ac0"]]);export{M as default};
