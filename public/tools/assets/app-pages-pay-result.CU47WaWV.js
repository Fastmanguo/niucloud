import{aN as a,d as e,r as t,H as s,c as l,w as r,n as o,i as n,b as u,e as c,c0 as p,ah as f,o as i,h as d,f as x,u as m,a7 as _,q as v,p as b,t as y,s as h,ap as T,Q as w,X as g,a as C,c1 as j}from"./index-DlbBJ3bC.js";import{_ as k}from"./top-tabbar.DzgP6uDu.js";import{t as P}from"./topTabbar.CE7B52mt.js";import"./manifest.DY5wYu7I.js";const R=e({__name:"result",setup(e){const R=t(null),$=t(!1);let B="",E=0,L=0;let V=P().setTopTabbarParam({title:"",isBack:!1});s((a=>{B=a.trade_type,E=a.trade_id,q()}));const q=()=>{(function(e,t){return a.get(`pay/info/${e}/${t}`,{},{showErrorMessage:!0})})(B,E).then((a=>{if(!uni.$u.test.isEmpty(a.data)){if(1==a.data.status&&L<5)return $.value=!0,L++,void setTimeout((()=>{q()}),1e3);R.value=a.data,$.value=!1}}))},z=()=>{var a;const e=decodeURIComponent(g("payReturn"));C(e?{url:e,mode:"reLaunch"}:{url:j(),param:{code:null==(a=R.value)?void 0:a.out_trade_no},mode:"reLaunch"})};return(a,e)=>{const t=u(c("top-tabbar"),k),s=v,g=n,C=w,j=u(c("u-loading-icon"),p),P=u(c("u-modal"),f);return i(),l(g,{style:o(a.themeColor())},{default:r((()=>[R.value?(i(),l(g,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:r((()=>[x(t,{ref:"topTabbarRef",data:m(V)},null,8,["data"]),x(g,{class:"flex-1 flex flex-col items-center w-full pt-[180rpx]"},{default:r((()=>[x(g,{class:_(["flex items-baseline",{"text-[#06c05d]":2==R.value.status,"text-red":2!=R.value.status}])},{default:r((()=>[x(s,{class:_(["nc-iconfont -mb-[4rpx] !text-[32rpx]",{"nc-icon-duihaoV6mm":2==R.value.status,"nc-icon-tanhaoV6mm":2!=R.value.status}])},null,8,["class"]),x(s,{class:"text-[36rpx] ml-[16rpx] font-500"},{default:r((()=>[b(y(2==R.value.status?"支付成功":"支付失败"),1)])),_:1})])),_:1},8,["class"]),x(g,{class:"text-[56rpx] font-500 mt-[60rpx] price-font"},{default:r((()=>[x(s,{class:"text-[36rpx] mr-[6rpx]"},{default:r((()=>[b(y(m(h)("currency")),1)])),_:1}),x(s,null,{default:r((()=>[b(y(m(T)(R.value.money)),1)])),_:1})])),_:1})])),_:1}),x(g,{class:"pb-[260rpx]"},{default:r((()=>[x(C,{class:"w-[380rpx] !border-0 h-[80rpx] text-[28rpx] text-[#333] !bg-[#f2f2f2] flex-center font-500 rounded-[20rpx]",plain:!0,onClick:z},{default:r((()=>[b(y(2==R.value.status?m(h)("complete"):m(h)("close")),1)])),_:1})])),_:1})])),_:1})):d("",!0),x(P,{show:$.value,showCancelButton:!0,confirmText:m(h)("pay.completePay"),cancelText:m(h)("pay.incompletePay"),onCancel:z,confirmColor:"var(--primary-color)"},{default:r((()=>[x(g,{class:"py-[20rpx]"},{default:r((()=>[x(j,{text:m(h)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])])),_:1},8,["style"])}}});export{R as default};
