import{d as e,E as a,j as l,r as t,W as r,H as o,X as s,s as d,c as i,w as n,n as p,i as u,L as c,F as m,b,Y as x,e as f,Z as g,$ as _,N as h,O as v,o as y,f as k,p as C,t as T,u as V,h as j,R as w,q as F,a as P,Q as O,a0 as S,a1 as U,S as q,_ as z}from"./index-DlbBJ3bC.js";import{_ as E}from"./sms-code.vue_vue_type_script_setup_true_lang.CJ6LD-h5.js";import{t as A}from"./topTabbar.CE7B52mt.js";const B=z(e({__name:"bind",setup(e){let z={};A().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a((()=>Object.keys(z).length?c(Number(z.height))+c(z.top)+c(8)+"rpx":"auto"));const B=l(),I=a((()=>B.info)),L=a((()=>m().login)),M=t(!1),N=t(!1),R=r({mobile:"",mobile_code:"",mobile_key:""}),$=t(!0);t(null),o((()=>{setTimeout((()=>{$.value=!1}),800),s("openid")&&Object.assign(R,{openid:s("openid")}),s("pid")&&Object.assign(R,{pid:s("pid")}),s("unionid")&&Object.assign(R,{unionid:s("unionid")})}));const H={mobile:[{type:"string",required:!0,message:d("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error("请输入正确的手机号"))},message:d("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:d("codePlaceholder"),trigger:["blur","change"]}},Q=()=>{N.value=!N.value},W=t(null),X=()=>{W.value.validate().then((()=>{if(M.value)return;M.value=!0;(I.value?S:U)(R).then((e=>{I.value?(B.getUserInfo(),P({url:"/app/pages/member/personal",mode:"redirectTo"})):(B.setToken(e.data.token),q().handleLoginBack())})).catch((()=>{M.value=!1}))}))};return(e,a)=>{const l=u,t=b(f("u-input"),x),r=b(f("u-form-item"),g),o=b(f("sms-code"),E),s=b(f("u-form"),_),c=b(f("u-checkbox"),h),m=b(f("u-checkbox-group"),v),S=F,U=O;return y(),i(l,{class:"w-screen h-screen flex flex-col",style:p(e.themeColor())},{default:n((()=>[k(l,{class:"mx-[60rpx]"},{default:n((()=>[k(l,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:n((()=>[C(T(V(d)("bindMobile")),1)])),_:1}),k(l,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[16rpx] mb-[80rpx]"},{default:n((()=>[C(T(V(d)("bindMobileTip")),1)])),_:1}),k(s,{labelPosition:"left",model:R,errorType:"toast",rules:H,ref_key:"formRef",ref:W},{default:n((()=>[k(l,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6]"},{default:n((()=>[k(r,{label:"",prop:"mobile","border-bottom":!1},{default:n((()=>[k(t,{modelValue:R.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>R.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:V(d)("mobilePlaceholder"),class:"!bg-transparent",disabled:$.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),k(l,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:n((()=>[k(r,{label:"",prop:"mobile_code","border-bottom":!1},{default:n((()=>[k(t,{modelValue:R.mobile_code,"onUpdate:modelValue":a[2]||(a[2]=e=>R.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:V(d)("codePlaceholder"),class:"!bg-transparent",disabled:$.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:n((()=>[k(o,{mobile:R.mobile,type:"bind_mobile",modelValue:R.mobile_key,"onUpdate:modelValue":a[1]||(a[1]=e=>R.mobile_key=e)},null,8,["mobile","modelValue"])])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})])),_:1})])),_:1},8,["model"]),k(l,{class:"mt-[100rpx]"},{default:n((()=>[L.value.agreement_show?(y(),i(l,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:w(Q,["stop"])},{default:n((()=>[k(m,{onChange:Q},{default:n((()=>[k(c,{activeColor:"var(--primary-color)",checked:N.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),k(l,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:n((()=>[k(S,null,{default:n((()=>[C(T(V(d)("agreeTips")),1)])),_:1}),k(S,{onClick:a[3]||(a[3]=w((e=>V(P)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:n((()=>[C("《"+T(V(d)("privacyAgreement"))+"》",1)])),_:1}),k(S,null,{default:n((()=>[C(T(V(d)("and")),1)])),_:1}),k(S,{onClick:a[4]||(a[4]=w((e=>V(P)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:n((()=>[C("《"+T(V(d)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1})):j("",!0),k(U,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:X},{default:n((()=>[C(T(V(d)("bind")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-9b30006f"]]);export{B as default};
