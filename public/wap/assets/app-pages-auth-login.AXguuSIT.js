import{d as e,y as a,r as l,j as t,z as s,B as r,C as o,S as n,Z as u,b as i,m as c,c as d,U as m,V as p,W as g,G as f,H as x,$ as b,o as h,e as v,w as _,f as y,p as k,a0 as w,u as C,a1 as T,h as P,a2 as V,I as j,t as A,n as S,J as q,s as B,E as U,a3 as z,a4 as E,A as L,N as R,a5 as I,a6 as N,a as W,i as $,q as F,M as G,_ as H}from"./index-VHk1sExB.js";import{t as J}from"./topTabbar.ClSS_mln.js";const M=H(e({__name:"login",setup(e){let H={};J().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a((()=>Object.keys(H).length?q(Number(H.height))+q(H.top)+q(8)+"rpx":"auto"));const M=l(!0),O=t(),X=s(),Z=l(""),D=l(!1),K=l(!1);r((async e=>{Z.value="username",o()?!X.login.is_username||X.login.is_mobile||X.login.is_auth_register?K.value=!0:K.value=!1:X.login.is_username&&!X.login.is_mobile?K.value=!1:K.value=!0}));const Q=n({username:"",password:"",mobile:"",mobile_code:"",mobile_key:""});u((()=>{setTimeout((()=>{M.value=!1}),800)}));const Y=()=>{D.value=!D.value},ee=()=>{Z.value="username"==Z.value?"mobile":"username"},ae=l(!1),le=a((()=>({username:{type:"string",required:"username"==Z.value,message:B("usernamePlaceholder"),trigger:["blur","change"]},password:{type:"string",required:"username"==Z.value,message:B("passwordPlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:"mobile"==Z.value,message:B("mobilePlaceholder"),trigger:["blur","change"]},{validator:(e,a)=>"mobile"!=Z.value||uni.$u.test.mobile(a),message:B("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:"mobile"==Z.value,message:B("codePlaceholder"),trigger:["blur","change"]}}))),te=l(null),se=()=>{te.value.validate().then((()=>{if(X.login.agreement_show&&!D.value)return U({title:B("isAgreeTips"),icon:"none"}),!1;if(ae.value)return;ae.value=!0;("username"==Z.value?z:E)(Q).then((e=>{O.setToken(e.data.token,(async()=>{await L().getSiteInfoFn(),R().handleLoginBack()}))})).catch((()=>{ae.value=!1}))}))},re=()=>{const e=I();if(e.length>1){"app/pages/auth/index"==e[e.length-2].route?N({delta:1}):W({url:"/app/pages/auth/index",mode:"redirectTo"})}else W({url:"/app/pages/auth/index",mode:"redirectTo"})};return(e,a)=>{const l=i(d("up-image"),c),t=$,s=i(d("u-input"),m),r=i(d("u-form-item"),p),o=i(d("u-form"),g),n=i(d("u-checkbox"),f),u=i(d("u-checkbox-group"),x),q=F,U=i(d("up-button"),b),z=G;return Z.value?(h(),v(t,{key:0,class:"w-screen h-screen flex flex-col bg-[#fff]",style:S(e.themeColor())},{default:_((()=>[y(t,{class:"my-20 px-5"},{default:_((()=>[y(t,{class:"flex items-center mb-5"},{default:_((()=>[y(l,{"show-loading":!0,src:"/static/assets/logo.png",width:"50px",height:"50px",radius:"50px"}),y(t,{class:"ml-2 text-base text-[var(--theme-color-main)] font-semibold"},{default:_((()=>[y(t,{class:"font-serif subpixel-antialiased"},{default:_((()=>[k(" LUXUR CENER ")])),_:1}),y(t,{class:"text-[var(--theme-color-main)]"},{default:_((()=>[k(" 立即登录 ")])),_:1})])),_:1})])),_:1}),y(o,{labelPosition:"left",model:Q,rules:le.value,ref_key:"formRef",ref:te},{default:_((()=>["username"==Z.value?(h(),w(T,{key:0},[y(r,{prop:"username",borderBottom:"",labelWidth:"0px",labelStyle:"font-size: 14px;"},{default:_((()=>[y(s,{modelValue:Q.username,"onUpdate:modelValue":a[0]||(a[0]=e=>Q.username=e),maxlength:"40",placeholder:C(B)("usernamePlaceholder"),clearable:"",autocomplete:"off",class:"!bg-transparent",disabled:M.value,fontSize:"14px"},null,8,["modelValue","placeholder","disabled"])])),_:1}),y(r,{label:"",prop:"password","border-bottom":!1,labelWidth:"0px"},{default:_((()=>[y(s,{modelValue:Q.password,"onUpdate:modelValue":a[1]||(a[1]=e=>Q.password=e),type:"password",maxlength:"40",clearable:"",placeholder:C(B)("passwordPlaceholder"),autocomplete:"new-password",class:"!bg-transparent",disabled:M.value},null,8,["modelValue","placeholder","disabled"])])),_:1})],64)):P("",!0)])),_:1},8,["model","rules"]),y(t,{class:V({"mt-[160rpx]":"username"!=Z.value,"mt-[106rpx]":"username"==Z.value})},{default:_((()=>[C(X).login.agreement_show?(h(),v(t,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:j(Y,["stop"])},{default:_((()=>[y(u,{onChange:Y},{default:_((()=>[y(n,{activeColor:"var(--primary-color)",checked:D.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),y(t,{class:"text-xs text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:_((()=>[y(q,null,{default:_((()=>[k(A(C(B)("agreeTips")),1)])),_:1}),y(q,{onClick:a[2]||(a[2]=j((e=>C(W)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:_((()=>[k("《"+A(C(B)("privacyAgreement"))+"》 ",1)])),_:1}),y(q,null,{default:_((()=>[k(A(C(B)("and")),1)])),_:1}),y(q,{onClick:a[3]||(a[3]=j((e=>C(W)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:_((()=>[k("《"+A(C(B)("userAgreement"))+"》 ",1)])),_:1})])),_:1})])),_:1})):P("",!0),y(U,{text:C(B)("login"),color:"var(--theme-color-primary)",loadingText:C(B)("logining"),onClick:se},null,8,["text","loadingText"]),y(t,{class:"flex items-center justify-between my-3"},{default:_((()=>["username"==Z.value&&C(X).login.is_mobile||"mobile"==Z.value&&C(X).login.is_username?(h(),v(t,{key:0,class:"text-[26rpx] text-[var(--text-color-light6)] leading-[34rpx]",onClick:ee},{default:_((()=>[k(A("username"==Z.value?C(B)("mobileLogin"):C(B)("accountLogin")),1)])),_:1})):P("",!0),y(t,{class:"text-xs flex justify-center items-center w-full text-[var(--theme-color-content)]",onClick:a[4]||(a[4]=e=>C(W)({url:"/app/pages/auth/register"}))},{default:_((()=>[y(q,null,{default:_((()=>[k(A(C(B)("noAccount"))+",",1)])),_:1}),y(q,{class:"text-primary"},{default:_((()=>[k(A(C(B)("toRegister")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["class"])])),_:1}),K.value?(h(),v(t,{key:0,class:"footer w-full"},{default:_((()=>[y(t,{class:"text-[26rpx] leading-[36rpx] text-[#333] text-center mb-[30rpx] font-400"},{default:_((()=>[k(A(C(B)("oneClicklogin")),1)])),_:1}),y(t,{class:"flex justify-center"},{default:_((()=>[y(z,{class:"h-[80rpx] w-[80rpx] text-[46rpx] !text-[#1AAB37] text-center !p-0 !bg-transparent leading-[79rpx] border-[2rpx] rounded-[50%] border-solid border-[#ddd] nc-iconfont nc-icon-weixinV6mm overflow-hidden",onClick:re})])),_:1})])),_:1})):P("",!0)])),_:1},8,["style"])):P("",!0)}}}),[["__scopeId","data-v-a291af8e"]]);export{M as default};
