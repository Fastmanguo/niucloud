import{d as e,y as l,j as a,r as t,S as r,B as o,T as s,s as d,b as i,U as n,c as p,V as u,W as c,G as m,H as b,o as x,e as f,w as g,f as _,p as h,t as v,u as y,I as k,h as T,n as C,J as V,z as j,X as w,Y as F,a as P,N as U,i as S,q as z,M as O,_ as q}from"./index-VHk1sExB.js";import{_ as B}from"./sms-code.vue_vue_type_script_setup_true_lang.BZ9qbxgm.js";import{t as I}from"./topTabbar.ClSS_mln.js";const M=q(e({__name:"bind",setup(e){let q={};I().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),l((()=>Object.keys(q).length?V(Number(q.height))+V(q.top)+V(8)+"rpx":"auto"));const M=a(),A=l((()=>M.info)),E=l((()=>j().login)),N=t(!1),G=t(!1),H=r({mobile:"",mobile_code:"",mobile_key:""}),J=t(!0);t(null),o((()=>{setTimeout((()=>{J.value=!1}),800),s("openid")&&Object.assign(H,{openid:s("openid")}),s("pid")&&Object.assign(H,{pid:s("pid")}),s("unionid")&&Object.assign(H,{unionid:s("unionid")})}));const L={mobile:[{type:"string",required:!0,message:d("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,l,a){/^1[3-9]\d{9}$/.test(l)?a():a(new Error("请输入正确的手机号"))},message:d("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:d("codePlaceholder"),trigger:["blur","change"]}},R=()=>{G.value=!G.value},W=t(null),X=()=>{W.value.validate().then((()=>{if(N.value)return;N.value=!0;(A.value?w:F)(H).then((e=>{A.value?(M.getUserInfo(),P({url:"/app/pages/member/personal",mode:"redirectTo"})):(M.setToken(e.data.token),U().handleLoginBack())})).catch((()=>{N.value=!1}))}))};return(e,l)=>{const a=S,t=i(p("u-input"),n),r=i(p("u-form-item"),u),o=i(p("sms-code"),B),s=i(p("u-form"),c),V=i(p("u-checkbox"),m),j=i(p("u-checkbox-group"),b),w=z,F=O;return x(),f(a,{class:"w-screen h-screen flex flex-col",style:C(e.themeColor())},{default:g((()=>[_(a,{class:"mx-[60rpx]"},{default:g((()=>[_(a,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:g((()=>[h(v(y(d)("bindMobile")),1)])),_:1}),_(a,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[16rpx] mb-[80rpx]"},{default:g((()=>[h(v(y(d)("bindMobileTip")),1)])),_:1}),_(s,{labelPosition:"left",model:H,errorType:"toast",rules:L,ref_key:"formRef",ref:W},{default:g((()=>[_(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6]"},{default:g((()=>[_(r,{label:"",prop:"mobile","border-bottom":!1},{default:g((()=>[_(t,{modelValue:H.mobile,"onUpdate:modelValue":l[0]||(l[0]=e=>H.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:y(d)("mobilePlaceholder"),class:"!bg-transparent",disabled:J.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),_(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:g((()=>[_(r,{label:"",prop:"mobile_code","border-bottom":!1},{default:g((()=>[_(t,{modelValue:H.mobile_code,"onUpdate:modelValue":l[2]||(l[2]=e=>H.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:y(d)("codePlaceholder"),class:"!bg-transparent",disabled:J.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:g((()=>[_(o,{mobile:H.mobile,type:"bind_mobile",modelValue:H.mobile_key,"onUpdate:modelValue":l[1]||(l[1]=e=>H.mobile_key=e)},null,8,["mobile","modelValue"])])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})])),_:1})])),_:1},8,["model"]),_(a,{class:"mt-[100rpx]"},{default:g((()=>[E.value.agreement_show?(x(),f(a,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:k(R,["stop"])},{default:g((()=>[_(j,{onChange:R},{default:g((()=>[_(V,{activeColor:"var(--primary-color)",checked:G.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),_(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:g((()=>[_(w,null,{default:g((()=>[h(v(y(d)("agreeTips")),1)])),_:1}),_(w,{onClick:l[3]||(l[3]=k((e=>y(P)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:g((()=>[h("《"+v(y(d)("privacyAgreement"))+"》",1)])),_:1}),_(w,null,{default:g((()=>[h(v(y(d)("and")),1)])),_:1}),_(w,{onClick:l[4]||(l[4]=k((e=>y(P)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:g((()=>[h("《"+v(y(d)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1})):T("",!0),_(F,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:X},{default:g((()=>[h(v(y(d)("bind")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-9b30006f"]]);export{M as default};
