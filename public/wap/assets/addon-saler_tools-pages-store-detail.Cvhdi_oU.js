import{d as e,S as l,ca as t,y as a,r as s,B as o,Q as r,b as c,x as n,c as i,c8 as m,cc as d,l as u,ce as f,b$ as p,c0 as x,cb as h,m as _,bG as v,G as b,H as g,$ as y,ac as k,o as w,a0 as C,e as j,w as z,f as P,g as S,v as U,p as I,t as V,u as B,I as A,a1 as E,am as M,h as T,a2 as $,n as R,an as q,ao as F,E as G,i as L,s as O,K as W,a as D,_ as H}from"./index-VHk1sExB.js";import{_ as K}from"./loading-page.vue_vue_type_script_setup_true_lang._vb0LNCj.js";import{u as N,M as Q}from"./useMescroll.Bh35ex94.js";import{M as X}from"./mescroll-empty.uEQNJN_1.js";import{e as Y}from"./warehouse.DBo3FtFy.js";import{c as J,k as Z}from"./goods.w7yS6gCV.js";import{g as ee}from"./common.Bw57JoDO.js";import{s as le}from"./index.Cs12rJwX.js";import"./mescroll-i18n.DUzOixk-.js";import"./index.CNqs6UPm.js";import"./index.D0Ed4zTg.js";import"./auth.CqjcWN4L.js";/* empty css                                                                     */const te=H(e({__name:"detail",setup(e){const H=l({store_id:0,storeInfo:null,searchParams:{search:"",category_id:null,is_sale:null,__order__:"",store:0,goods_attribute:""},mescrollUp:{page:{size:10}},list:[],loading:!0}),te=t(),ae=a({get:()=>[{category_key:"ALL",category_id:null},...te.value],set(e){}}),se=e=>{H.searchParams.category_id=e.category_id,_e().resetUpScroll()},oe=s(!1),re=s(!1),ce=s(!1),ne=s(!1),ie=s(!1),me=s("按最近更新"),de=l([{label:"按最近更新",value:""},{label:"按最久更新",value:"update_time,asc"},{label:"按入库最新",value:"create_time,desc"},{label:"按入库最久",value:"create_time,asc"},{label:"按价格最高",value:"price,desc"},{label:"按价格最低",value:"price,asc"}]),ue=s(!0),fe=s(),pe=e=>{let l={page:e.num,limit:e.size,...H.searchParams};console.log("loadPage-state.searchParams",H.searchParams),J(l).then((l=>{let t=l.data.data;1==e.num&&(H.list=[]),H.list=H.list.concat(t),H.list.forEach((e=>{e.selected=!1})),e.endSuccess(l.data.data.length)})).catch((()=>{e.endErr()}))},{mescrollInit:xe,downCallback:he,getMescroll:_e}=N(F,q),ve=e=>{e.selected=!e.selected,H.list.some((e=>!e.selected))?ge.selected=!1:ge.selected=!0},be=a((()=>H.list.filter((e=>e.selected)).length)),ge=l({name:"全选",selected:!1}),ye=l({name:"反选",selected:!1}),ke=()=>{H.list.forEach(((e,l)=>{e.selected=!ge.selected})),ge.selected=!ge.selected},we=()=>{H.list.forEach(((e,l)=>{e.selected=!e.selected})),H.list.some((e=>!e.selected))?ge.selected=!1:ge.selected=!0};return o((async e=>{e.store_id?(H.store_id=e.store_id,H.searchParams.store_id=H.store_id,await Y(H.store_id).then((({data:e})=>{H.storeInfo=e})).catch((e=>r({title:e.msg,url:"/addon/saler_tools/pages/store/list"})))):H.searchParams.store_id="temp_store",H.loading=!1})),(e,l)=>{const t=L,a=c(i("up-navbar"),n),s=c(i("up-search"),m),o=c(i("up-tabs"),d),r=c(i("up-icon"),u),q=c(i("up-divider"),f),F=c(i("up-radio"),p),N=c(i("up-radio-group"),x),Y=c(i("up-overlay"),h),J=c(i("up-image"),_),te=c(i("up-text"),v),he=c(i("up-checkbox"),b),Ce=c(i("up-checkbox-group"),g),je=c(i("up-button"),y),ze=c(i("up-modal"),k),Pe=c(i("loading-page"),K);return w(),C(E,null,[H.loading?T("",!0):(w(),j(t,{key:0,style:R(e.themeColor())},{default:z((()=>[P(a,{title:H.storeInfo?H.storeInfo.store_name:"临时仓",autoBack:!0,safeAreaInsetTop:!0,placeholder:!0},{right:z((()=>[P(t,{class:"u-nav-slot"},{default:z((()=>[S(P(t,{onClick:l[0]||(l[0]=e=>oe.value=!0),class:"text-xs text-[var(--theme-color-content)]"},{default:z((()=>[I("操作 ")])),_:1},512),[[U,!oe.value]]),S(P(t,{onClick:l[1]||(l[1]=e=>oe.value=!1),class:"text-xs text-[var(--theme-color-content)]"},{default:z((()=>[I("取消 ")])),_:1},512),[[U,oe.value]])])),_:1})])),_:1},8,["title"]),P(t,{class:"mescroll-fixed-header !bg-[#f4f4f4]"},{default:z((()=>[P(t,{class:"bg-[#fff] p-2"},{default:z((()=>[P(s,{placeholder:"搜索商品名称/描述/备注/独立编码",shape:"square",modelValue:H.searchParams.search,"onUpdate:modelValue":l[2]||(l[2]=e=>H.searchParams.search=e),onChange:l[3]||(l[3]=e=>(H.list=[],void _e().resetUpScroll())),showAction:!1},null,8,["modelValue"])])),_:1}),P(t,{class:"bg-[#fff] py-2"},{default:z((()=>[P(o,{list:ae.value,keyName:"category_name",activeStyle:"color:var(--theme-color-primary);font-size:16px",lineWidth:"30",onChange:se,lineColor:"var(--theme-color-primary)",scrollable:!1,inactiveStyle:"color:var(--theme-color-main);font-size:13px",itemStyle:"padding:0px 5px 3px;z-index:2"},{content:z((e=>[I(V(B(O)(e.item.category_key)),1)])),_:1},8,["list"])])),_:1}),P(t,{class:"px-3 py-2 flex justify-between items-center w-full box-border text-[13px] bg-[#fff] mt-1"},{default:z((()=>[P(t,{class:"mt-[5px] flex items-center flex-1"},{default:z((()=>[P(t,{class:"flex mr-5",onClick:l[5]||(l[5]=e=>ie.value=!ie.value)},{default:z((()=>[P(t,{class:"flex justify-start items-center"},{default:z((()=>[I(V(me.value)+" ",1),P(r,{name:"arrow-down",bold:"",size:"13",class:"ml-1",onClick:l[4]||(l[4]=()=>{}),color:"var(--theme-color-main)"})])),_:1})])),_:1}),P(t,{class:"flex justify-start items-center"},{default:z((()=>[I(V(ue.value?"显示":"隐藏")+"全部信息 ",1),P(r,{name:ue.value?"eye":"eye-off",bold:"",size:"16",class:"ml-1",onClick:l[6]||(l[6]=e=>ue.value=!ue.value),color:"var(--theme-color-main)"},null,8,["name"])])),_:1})])),_:1}),P(t,{class:"flex justify-start items-center mt-[5px]",onClick:l[8]||(l[8]=e=>fe.value.open())},{default:z((()=>[I(" 筛选 "),P(r,{name:"/static/assets/stock/screen.png",bold:"",size:"16",class:"ml-1",onClick:l[7]||(l[7]=()=>{}),color:"var(--theme-color-main)"})])),_:1})])),_:1})])),_:1}),P(q,{class:"!m-0",hairline:!0}),P(t,{class:"flex justify-between items-center text-xs text-[var(--theme-color-content)] bg-[#fff] w-full box-border py-3 hidden"},{default:z((()=>[P(t,{class:"flex-1 flex text-center flex-col items-center mr-1"},{default:z((()=>[P(t,{class:"mb-1 text-[var(--theme-color-main)] text-sm"},{default:z((()=>[I("0")])),_:1}),P(t,null,{default:z((()=>[I("总数量")])),_:1})])),_:1}),P(t,{class:"flex-1 flex text-center flex-col items-center mr-1"},{default:z((()=>[P(t,{class:"mb-1 text-[var(--theme-color-main)] text-sm"},{default:z((()=>[I(" 850,504 ")])),_:1}),P(t,null,{default:z((()=>[I("总销量")])),_:1})])),_:1}),P(t,{class:"flex-1 flex text-center flex-col items-center mr-1"},{default:z((()=>[P(t,{class:"mb-1 text-[var(--theme-color-main)] text-sm"},{default:z((()=>[I(" 106,850,504 ")])),_:1}),P(r,{name:"question-circle",label:"总成本",labelPos:"left",onClick:l[9]||(l[9]=e=>ne.value=!0),labelSize:"14",size:"14",color:"var(--theme-color-primary)",labelColor:"var(--theme-color-primary)",class:"mr-1"})])),_:1})])),_:1}),P(q,{class:"!m-0",hairline:!0}),P(t,{class:"p-3 pt-2 flex justify-end items-center mb-1 bg-[#fff] hidden"},{default:z((()=>[P(r,{name:"arrow-right",label:"临时仓操作日志",labelPos:"left",labelSize:"14",size:"14",space:"1",color:"var(--theme-color-tips)",labelColor:"var(--theme-color-tips)"})])),_:1}),P(Y,{class:"mt-[150px] sort-card",show:ie.value,onClick:l[12]||(l[12]=e=>ie.value=!1)},{default:z((()=>[S(P(N,{modelValue:me.value,"onUpdate:modelValue":l[10]||(l[10]=e=>me.value=e),placement:"column",iconPlacement:"right",onClick:l[11]||(l[11]=A((()=>{}),["stop"])),activeColor:"#fff",iconColor:"#000",class:"px-3 py-2 box-border bg-[#fff] border-none"},{default:z((()=>[(w(!0),C(E,null,M(de,((e,l)=>(w(),j(F,{customStyle:{marginBottom:"8px"},key:l,iconSize:"20",onChange:l=>(e=>{me.value=e,H.searchParams.__order__=e.value,_e().resetUpScroll(),ie.value=!1})(e),iconColor:"var(--theme-color-main)",labelSize:"13",label:e.label,labelColor:me.value==e.label?"var(--theme-color-main)":"var(--theme-color-tips)",name:e.label},null,8,["onChange","label","labelColor","name"])))),128))])),_:1},8,["modelValue"]),[[U,ie.value]])])),_:1},8,["show"]),P(Q,{ref:"mescrollRef",onInit:B(xe),onUp:pe,onDown:pe,up:H.mescrollUp,top:"0"},{default:z((()=>[P(t,null,{default:z((()=>[(w(!0),C(E,null,M(H.list,((e,a)=>(w(),C(E,null,[P(t,{class:"flex flex-col p-3 bg-[#fff] box-border"},{default:z((()=>[P(t,{class:"flex justify-between items-center min-h-[90px]",onClick:l=>((e,l)=>{l?ve(e):D({url:`/addon/saler_tools/pages/product/detail?goods_id=${e.goods_id}`})})(e,oe.value)},{default:z((()=>[P(t,null,{default:z((()=>[e.goods_cover?(w(),j(J,{key:0,"show-loading":!0,src:B(W)(e.goods_cover),mode:"aspectFit",width:"100px",radius:"5",height:"100px",class:"z-10 flex items-center"},null,8,["src"])):(w(),j(J,{key:1,"show-loading":!0,src:B(W)(B(ee)),mode:"aspectFit",width:"100px",radius:"5",height:"100px",class:"z-10 flex items-center"},null,8,["src"]))])),_:2},1024),P(t,{class:"flex justify-between flex-col flex-1 pl-2 min-h-[90px]"},{default:z((()=>[P(t,{class:"flex items-baseline leading-5 text-[14px] card-item flex-1"},{default:z((()=>[P(t,{class:"text-[var(--theme-color-main)] flex-1 min-h-[45px]"},{default:z((()=>[P(te,{lines:2,text:e.goods_name},null,8,["text"])])),_:2},1024),S(P(t,{class:"ml-1"},{default:z((()=>[P(Ce,{placement:"column"},{default:z((()=>[(w(),j(he,{key:a,checked:e.selected,"onUpdate:checked":l=>e.selected=l,shape:"circle",onChange:l=>ve(e),activeColor:"var(--theme-color-primary)"},null,8,["checked","onUpdate:checked","onChange"]))])),_:2},1024)])),_:2},1536),[[U,oe.value]])])),_:2},1024),P(t,{class:"flex justify-between items-center mb-2",onClick:l[13]||(l[13]=A((e=>ue.value=!ue.value),["stop"]))},{default:z((()=>[S(P(t,{class:"flex items-center justify-start text-[13px] flex-1 text-[var(--theme-color-content)]"},{default:z((()=>[I(" ￥"+V(e.total_cost)+" ",1),P(t,{class:"ml-1 text-[10px]"},{default:z((()=>[I(" 总到手价 ")])),_:1})])),_:2},1536),[[U,ue.value]]),P(t,{class:"flex items-center justify-end text-[13px] flex-1 text-[var(--theme-text-red)]"},{default:z((()=>[I(" ￥"+V(e.price)+" ",1),P(t,{class:"ml-1 text-[10px] text-[var(--theme-color-main)]"},{default:z((()=>[I(" 结算价 ")])),_:1})])),_:2},1024)])),_:2},1024),P(t,{class:"flex justify-between items-center text-xs text-[var(--theme-color-tips)]"},{default:z((()=>[P(t,null,{default:z((()=>[I("更新时间："+V(e.update_time),1)])),_:2},1024),S(P(t,{class:"text-right text-[var(--theme-color-tips)]"},{default:z((()=>[I(" 数量 "+V(e.stock),1)])),_:2},1536),[[U,ue.value]])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024),P(q,{class:"!p-0 !m-0"})],64)))),256))])),_:1}),H.list.length?T("",!0):(w(),j(X,{key:0,option:{tip:"暂无商品"}}))])),_:1},8,["onInit","up"]),P(t,{class:"main-fix-footer",style:{"box-shadow":"var(--theme-box-shadow)"}},{default:z((()=>[S(P(t,{class:"flex justify-between h-[30px] items-center mb-2"},{default:z((()=>[P(t,{class:$(["px-3 py-1 rounded mr-3 text-xs",be.value>0?"bg-[var(--theme-color-primary)] text-[#fff]":"bg-[var(--theme-input-bg)] text-[var(--theme-color-content)]"])},{default:z((()=>[I(" 已选商品("+V(be.value)+") ",1)])),_:1},8,["class"]),P(t,{class:"flex flex-1 items-center justify-start text-base"},{default:z((()=>[P(Ce,{placement:"row",activeColor:"var(--theme-color-primary)"},{default:z((()=>[P(he,{checked:ge.selected,"onUpdate:checked":l[14]||(l[14]=e=>ge.selected=e),shape:"circle",label:ge.name,onChange:ke},null,8,["checked","label"])])),_:1}),S(P(t,{class:"text-sm"},{default:z((()=>[I(" ("+V(be.value)+") ",1)])),_:1},512),[[U,0!=be.value]]),P(t,{class:"ml-5"},{default:z((()=>[P(Ce,{placement:"row",activeColor:"var(--theme-color-primary)"},{default:z((()=>[P(he,{checked:ye.selected,"onUpdate:checked":l[15]||(l[15]=e=>ye.selected=e),shape:"circle",label:ye.name,onChange:we},null,8,["checked","label"])])),_:1})])),_:1})])),_:1})])),_:1},512),[[U,oe.value]]),P(t,{class:"z-100 flex justify-between items-center"},{default:z((()=>[P(t,{class:"flex w-1/3 justify-center"},{default:z((()=>[P(r,{name:"/static/assets/order/share.png",size:"25",labelPos:"bottom",labelSize:"13",labelColor:"var(--theme-color-main)",label:"添加商品",onClick:l[16]||(l[16]=e=>B(D)({url:`/addon/saler_tools/pages/store/select?type=add&store_name=${H.storeInfo.store_name}`}))})])),_:1}),P(t,{class:"flex w-1/3 justify-center"},{default:z((()=>[P(r,{name:"/static/assets/order/sales_return.png",size:"25",labelPos:"bottom",labelSize:"13",labelColor:"var(--theme-color-main)",label:"转出商品",onClick:l[17]||(l[17]=e=>B(D)({url:"/addon/saler_tools/pages/commodityInventory/temporaryWarehouse?type=transfer"}))})])),_:1}),P(t,{class:"flex w-1/3 justify-center"},{default:z((()=>[oe.value?(w(),j(r,{key:0,name:"/static/assets/order/delete.png",size:"25",onClick:l[18]||(l[18]=e=>ce.value=!0),labelPos:"bottom",labelSize:"13",labelColor:"var(--theme-color-main)",label:"移除",color:"var(--theme-color-primary)",bold:""})):(w(),j(r,{key:1,name:"/static/assets/order/delete.png",size:"25",onClick:l[19]||(l[19]=e=>re.value=!0),labelPos:"bottom",labelSize:"13",labelColor:"var(--theme-color-main)",label:"一键清空",color:"var(--theme-color-primary)",bold:""}))])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])),P(le,{ref_key:"screenPopupRef",ref:fe,modelValue:H.searchParams,"onUpdate:modelValue":l[20]||(l[20]=e=>H.searchParams=e)},null,8,["modelValue"]),P(ze,{show:ne.value,closeOnClickOverlay:!0,width:"300px",contentTextAlign:"center"},{default:z((()=>[P(t,{class:"flex flex-col text-sm w-full"},{default:z((()=>[P(t,{class:"flex justify-between items-center w-full box-border mb-1"},{default:z((()=>[I(" 商品原始总成本 "),P(t,null,{default:z((()=>[I("￥801,890,000")])),_:1})])),_:1}),P(t,{class:"flex justify-between items-center w-full box-border"},{default:z((()=>[I(" 商品附加成本 "),P(t,null,{default:z((()=>[I("￥0")])),_:1})])),_:1})])),_:1})])),confirmButton:z((()=>[P(je,{text:"我知道了",onClick:l[21]||(l[21]=e=>ne.value=!1),color:"var(--theme-color-primary)"})])),_:1},8,["show"]),P(ze,{show:re.value,"onUpdate:show":l[24]||(l[24]=e=>re.value=e),width:300,showConfirmButton:!1,contentTextAlign:"center"},{confirmButton:z((()=>[P(t,{class:"flex gap-3"},{default:z((()=>[P(je,{onClick:l[22]||(l[22]=e=>re.value=!1),class:"!text-[var(--theme-color-main)]",color:"#f4f5f7",text:"取消"}),P(je,{text:"确定",onClick:l[23]||(l[23]=e=>(Z({goods_ids:H.list.filter((e=>e.selected)).map((e=>e.goods_id))}).then((()=>{G({title:"删除成功"})})).catch((e=>{G({title:e.msg,icon:"none"})})),void(re.value=!1))),color:"var(--theme-color-primary)"})])),_:1})])),default:z((()=>[P(t,{class:"flex flex-col !box-border w-full text-[var(--theme-color-main)]"},{default:z((()=>[I(" 确认一键清空“"+V(H.storeInfo.store_name)+"”？ ",1)])),_:1})])),_:1},8,["show"]),P(ze,{show:ce.value,"onUpdate:show":l[27]||(l[27]=e=>ce.value=e),width:300,showConfirmButton:!1,contentTextAlign:"center"},{confirmButton:z((()=>[P(t,{class:"flex gap-3"},{default:z((()=>[P(je,{onClick:l[25]||(l[25]=e=>ce.value=!1),class:"!text-[var(--theme-color-main)]",color:"#f4f5f7",text:"取消"}),P(je,{text:"确定",onClick:l[26]||(l[26]=e=>(()=>{let e=[];e=H.list.filter((e=>e.selected)).map((e=>e.goods_id)),Z({goods_ids:e}).then((()=>{G({title:"删除成功"}),ce.value=!1})).catch((e=>{G({title:e.msg,icon:"none"})})),oe.value=!1,ce.value=!1})()),color:"var(--theme-color-primary)"})])),_:1})])),default:z((()=>[P(t,{class:"flex flex-col !box-border w-full text-[var(--theme-color-main)]"},{default:z((()=>[I(" 确认删除此商品？ ")])),_:1})])),_:1},8,["show"]),P(Pe,{loading:H.loading},null,8,["loading"])],64)}}}),[["__scopeId","data-v-6c4e4232"]]);export{te as default};
